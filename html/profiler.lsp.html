<!DOCTYPE HTML PUBLIC "HTML 4.01 Transitional">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>profiler.lsp</title>

<link rel="stylesheet" type="text/css" href="newlispdoc.css" />
</head>

<body style="margin: 20px;" text="#111111" bgcolor="#FFFFFF" 
			link="#376590" vlink="#551A8B" alink="#ffAA28">
<blockquote>
<center><h1>profiler.lsp</h1></center>
<p><a href="index.html">Module index</a></p><a href="profiler.lsp.src.html">source</a>&nbsp;<br/>
<h2>Module:&nbsp;Profiler</h2><b>Author: </b>Jeff Ober <jeffober@gmail.com><br/>
<b>Version: </b>1.0<br/>
<b>Location: </b><a href="http://static.artfulcode.net/newlisp/profiler.lsp">http://static.artfulcode.net/newlisp/profiler.lsp</a><br/>
<b>package: </b>http://static.artfulcode.net/newlisp/profiler.qwerty<br/>
<p>Profiles applications to help identify bottlenecks (updated for newlisp 10)</p>
 <h4>Version history</h4>
 <b>1.3</b>
 &bull; fixed incompatibilities with newlisp 10
<br/><br/>
 <b>1.2</b>
 &bull; added percentage of total time to report
 &bull; added ability to sort report by column
<br/><br/>
 <b>1.1</b>
 &bull; updated report to dynamically calculate column lengths
 &bull; updated profile-context to accept multiple contexts
<br/><br/>
 <b>1.0</b>
 &bull; initial release
<br/><br/>
<b>example:</b><blockquote><pre> (define (fib:fib n)
   (if (&lt; n 2) 1
       (+ (fib (- n 1)) (fib (- n 2)))))
 
 (define (fib-memo:fib-memo n)
   (or (context 'fib-memo (string n))
       (if (&lt; n 2) 1
           (context 'fib-memo (string n)
             (+ (fib-memo (- n 1)) (fib-memo (- n 2)))))))
 
 (Profiler:profile-context fib fib-memo)
 (dotimes (i 25)
   (println "Fib  " i ": " (fib i))
   (fib-memo i))
 (println)
 (Profiler:report 'calls)
 
 =&gt;
 Fib  0: 1
 Fib  1: 1
 Fib  2: 2
 Fib  3: 3
 Fib  4: 5
 Fib  5: 8
 Fib  6: 13
 Fib  7: 21
 Fib  8: 34
 Fib  9: 55
 Fib  10: 89
 Fib  11: 144
 Fib  12: 233
 Fib  13: 377
 Fib  14: 610
 Fib  15: 987
 Fib  16: 1597
 Fib  17: 2584
 Fib  18: 4181
 Fib  19: 6765
 Fib  20: 10946
 Fib  21: 17711
 Fib  22: 28657
 Fib  23: 46368
 Fib  24: 75025
 
 function           |      calls |   total ms |       ms/call |     % time
 -------------------+------------+------------+---------------+-----------
 fib:fib            |      24169 |       4942 |      0.204477 |     100.00
 fib-memo:fib-memo  |         71 |          0 |      0.000000 |       0.00</pre></blockquote>
<br/><br/><center>&sect;</center><br/>
<a name="Profiler_reset-functions"></a><h3><font color=#CC0000>Profiler:reset-functions</font></h3>
<b>syntax: (<font color=#CC0000>Profiler:reset-functions</font>)</b><br/>
 <p>Resets functions to their values prior to being adapted for profiling.
 This function is automatically called when a profiler report is printed.</p>

<br/><br/><center>&sect;</center><br/>
<a name="Profiler_reset-statistics"></a><h3><font color=#CC0000>Profiler:reset-statistics</font></h3>
<b>syntax: (<font color=#CC0000>Profiler:reset-statistics</font>)</b><br/>
 <p>Resets profiler statistics. This function is automatically called when a
 profiler report is printed.</p>

<br/><br/><center>&sect;</center><br/>
<a name="Profiler_report"></a><h3><font color=#CC0000>Profiler:report</font></h3>
<b>syntax: (<font color=#CC0000>Profiler:report</font> <em>sort-by</em>)</b><br/>
<b>parameter: </b>column - to sort by (descending order); default is 'calls.<br/>
 <p>Prints statistics for functions profiled.  <em>sort-by</em> may be 'times, 'calls, 'per-call,
 or 'percentage.  Sorts by number of calls by default.</p>




<br/><br/><center>&sect;</center><br/>
<a name="Profiler_profiled-function"></a><h3><font color=#CC0000>Profiler:profiled-function</font></h3>
<b>syntax: (<font color=#CC0000>Profiler:profiled-function</font> <em>func</em>)</b><br/>
<b>parameter: </b><em>func</em> - function to profile<br/>
 <p>Returns a modified function to use with the profiler.</p>

<br/><br/><center>&sect;</center><br/>
<a name="Profiler_profile-functions"></a><h3><font color=#CC0000>Profiler:profile-functions</font></h3>
<b>syntax: (<font color=#CC0000>Profiler:profile-functions</font> <em>list-functions</em>)</b><br/>
<b>parameter: </b><em>list-functions</em> - list of functions to profile<br/>
 <p>Sets functions listed in <em>list-functions</em> to have statistics collected while
 they run.  Protected and built-in functions cannot be profiled.</p>
<b>example:</b><blockquote><pre> (define (foo x y) (+ x y))
 (define (bar x y) (foo x y))
 (Profiler:profile-functions '(foo bar))
 =&gt; '(foo bar)</pre></blockquote>
<br/><br/><center>&sect;</center><br/>
<a name="Profiler_profile-context"></a><h3><font color=#CC0000>Profiler:profile-context</font></h3>
<b>syntax: (<font color=#CC0000>Profiler:profile-context</font> <em>ctx</em> [<em>ctx-2</em> ...])</b><br/>
<b>parameter: </b><em>ctx</em> - context to profile<br/>
 <p>Updates all functions in context <em>ctx</em> to be profiled.</p>
<b>example:</b><blockquote><pre> (define (foo:foo x y) (+ x y))
 (define (foo:bar x y) (foo x y))
 (Profiler:profile-context foo)
 =&gt; '(foo:bar foo:foo)</pre></blockquote>

<br/><br/><center>- &part; -</center><br/>
<center><font face='Arial' size='-2' color='#444444'>
generated with <a href="http://newlisp.org">newLISP</a>&nbsp;
and <a href="http://newlisp.org/newLISPdoc.html">newLISPdoc</a>
</font></center>
</blockquote>
</body>
</html>
