<!DOCTYPE HTML PUBLIC "4.01 Transitional"><html><title>Profiler</title><body><pre>
<font color='#555555'>;; <font color='#308080'>@module</font> Profiler</font>
<font color='#555555'>;; <font color='#308080'>@author</font> Jeff Ober &lt;jeffober@gmail.com&gt;</font>
<font color='#555555'>;; <font color='#308080'>@version</font> 1.0</font>
<font color='#555555'>;; <font color='#308080'>@location</font> http://static.artfulcode.net/newlisp/profiler.lsp</font>
<font color='#555555'>;; <font color='#308080'>@package</font> http://static.artfulcode.net/newlisp/profiler.qwerty</font>
<font color='#555555'>;; <font color='#308080'>@description</font> Profiles applications to help identify bottlenecks (updated for newlisp 10)</font>
<font color='#555555'>;; &lt;h4&gt;Version history&lt;/h4&gt;</font>
<font color='#555555'>;; &lt;b&gt;1.3&lt;/b&gt;</font>
<font color='#555555'>;; &amp;bull; fixed incompatibilities with newlisp 10</font>
<font color='#555555'>;; </font>
<font color='#555555'>;; &lt;b&gt;1.2&lt;/b&gt;</font>
<font color='#555555'>;; &amp;bull; added percentage of total time to report</font>
<font color='#555555'>;; &amp;bull; added ability to sort report by column</font>
<font color='#555555'>;; </font>
<font color='#555555'>;; &lt;b&gt;1.1&lt;/b&gt;</font>
<font color='#555555'>;; &amp;bull; updated report to dynamically calculate column lengths</font>
<font color='#555555'>;; &amp;bull; updated profile-context to accept multiple contexts</font>
<font color='#555555'>;; </font>
<font color='#555555'>;; &lt;b&gt;1.0&lt;/b&gt;</font>
<font color='#555555'>;; &amp;bull; initial release</font>
<font color='#555555'>;; </font>
<font color='#555555'>;; <font color='#308080'>@example</font></font>
<font color='#555555'>;; (define (fib:fib n)</font>
<font color='#555555'>;;   (if (< n 2) 1</font>
<font color='#555555'>;;       (+ (fib (- n 1)) (fib (- n 2)))))</font>
<font color='#555555'>;; </font>
<font color='#555555'>;; (define (fib-memo:fib-memo n)</font>
<font color='#555555'>;;   (or (context 'fib-memo (string n))</font>
<font color='#555555'>;;       (if (< n 2) 1</font>
<font color='#555555'>;;           (context 'fib-memo (string n)</font>
<font color='#555555'>;;             (+ (fib-memo (- n 1)) (fib-memo (- n 2)))))))</font>
<font color='#555555'>;; </font>
<font color='#555555'>;; (Profiler:profile-context fib fib-memo)</font>
<font color='#555555'>;; (dotimes (i 25)</font>
<font color='#555555'>;;   (println "Fib  " i ": " (fib i))</font>
<font color='#555555'>;;   (fib-memo i))</font>
<font color='#555555'>;; (println)</font>
<font color='#555555'>;; (Profiler:report 'calls)</font>
<font color='#555555'>;; </font>
<font color='#555555'>;; =></font>
<font color='#555555'>;; Fib  0: 1</font>
<font color='#555555'>;; Fib  1: 1</font>
<font color='#555555'>;; Fib  2: 2</font>
<font color='#555555'>;; Fib  3: 3</font>
<font color='#555555'>;; Fib  4: 5</font>
<font color='#555555'>;; Fib  5: 8</font>
<font color='#555555'>;; Fib  6: 13</font>
<font color='#555555'>;; Fib  7: 21</font>
<font color='#555555'>;; Fib  8: 34</font>
<font color='#555555'>;; Fib  9: 55</font>
<font color='#555555'>;; Fib  10: 89</font>
<font color='#555555'>;; Fib  11: 144</font>
<font color='#555555'>;; Fib  12: 233</font>
<font color='#555555'>;; Fib  13: 377</font>
<font color='#555555'>;; Fib  14: 610</font>
<font color='#555555'>;; Fib  15: 987</font>
<font color='#555555'>;; Fib  16: 1597</font>
<font color='#555555'>;; Fib  17: 2584</font>
<font color='#555555'>;; Fib  18: 4181</font>
<font color='#555555'>;; Fib  19: 6765</font>
<font color='#555555'>;; Fib  20: 10946</font>
<font color='#555555'>;; Fib  21: 17711</font>
<font color='#555555'>;; Fib  22: 28657</font>
<font color='#555555'>;; Fib  23: 46368</font>
<font color='#555555'>;; Fib  24: 75025</font>
<font color='#555555'>;; </font>
<font color='#555555'>;; function           |      calls |   total ms |       ms/call |     % time</font>
<font color='#555555'>;; -------------------+------------+------------+---------------+-----------</font>
<font color='#555555'>;; fib:fib            |      24169 |       4942 |      0.204477 |     100.00</font>
<font color='#555555'>;; fib-memo:fib-memo  |         71 |          0 |      0.000000 |       0.00</font>

<font color='#AA0000'>(</font><font color='#0000AA'>define</font> calls:calls<font color='#AA0000'>)</font>
<font color='#AA0000'>(</font><font color='#0000AA'>define</font> times:times<font color='#AA0000'>)</font>

<font color='#AA0000'>(</font><font color='#0000AA'>context</font> 'Profiler<font color='#AA0000'>)</font>

<font color='#AA0000'>(</font><font color='#0000AA'>setq</font> profiled '<font color='#AA0000'>(</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font>
<font color='#AA0000'>(</font><font color='#0000AA'>set</font> 'originals '<font color='#AA0000'>(</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font>

<font color='#555555'>;; <font color='#308080'>@syntax</font> (Profiler:reset-functions)</font>
<font color='#555555'>;; &lt;p&gt;Resets functions to their values prior to being adapted for profiling.</font>
<font color='#555555'>;; This function is automatically called when a profiler report is printed.&lt;/p&gt;</font>
<font color='#AA0000'>(</font><font color='#0000AA'>define</font> <font color='#AA0000'>(</font>reset-functions<font color='#AA0000'>)</font>
  <font color='#AA0000'>(</font><font color='#0000AA'>dolist</font> <font color='#AA0000'>(</font>f originals<font color='#AA0000'>)</font>
    <font color='#AA0000'>(</font><font color='#0000AA'>set</font> <font color='#AA0000'>(</font><font color='#0000AA'>first</font> f<font color='#AA0000'>)</font> <font color='#AA0000'>(</font><font color='#0000AA'>last</font> f<font color='#AA0000'>)</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font>

<font color='#555555'>;; <font color='#308080'>@syntax</font> (Profiler:reset-statistics)</font>
<font color='#555555'>;; &lt;p&gt;Resets profiler statistics. This function is automatically called when a</font>
<font color='#555555'>;; profiler report is printed.&lt;/p&gt;</font>
<font color='#AA0000'>(</font><font color='#0000AA'>define</font> <font color='#AA0000'>(</font>reset-statistics<font color='#AA0000'>)</font>
  <font color='#AA0000'>(</font><font color='#0000AA'>dolist</font> <font color='#AA0000'>(</font>p profiled<font color='#AA0000'>)</font>
    <font color='#AA0000'>(</font>calls p <font color='#0000AA'>nil</font><font color='#AA0000'>)</font>
    <font color='#AA0000'>(</font>times p <font color='#0000AA'>nil</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font>
  <font color='#AA0000'>(</font><font color='#0000AA'>set</font> 'profiled '<font color='#AA0000'>(</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font>
  <font color='#AA0000'>(</font><font color='#0000AA'>set</font> 'originals '<font color='#AA0000'>(</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font>

<font color='#555555'>;; <font color='#308080'>@syntax</font> (Profiler:report &lt;sort-by&gt;)</font>
<font color='#555555'>;; <font color='#308080'>@param</font> column to sort by (descending order); default is 'calls.</font>
<font color='#555555'>;; &lt;p&gt;Prints statistics for functions profiled.  &lt;sort-by&gt; may be 'times, 'calls, 'per-call,</font>
<font color='#555555'>;; or 'percentage.  Sorts by number of calls by default.&lt;/p&gt;</font>
<font color='#AA0000'>(</font><font color='#0000AA'>define</font> <font color='#AA0000'>(</font>row-width func<font color='#AA0000'>)</font>
  <font color='#AA0000'>(</font><font color='#0000AA'>+</font> <font color='#665500'>1</font> <font color='#AA0000'>(</font><font color='#0000AA'>apply</font> 'max <font color='#AA0000'>(</font><font color='#0000AA'>cons</font> <font color='#665500'>9</font> <font color='#AA0000'>(</font><font color='#0000AA'>map</font> 'length <font color='#AA0000'>(</font><font color='#0000AA'>map</font> 'string <font color='#AA0000'>(</font><font color='#0000AA'>map</font> func profiled<font color='#AA0000'>)</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font>

<font color='#AA0000'>(</font><font color='#0000AA'>define</font> <font color='#AA0000'>(</font>time/call f , c t<font color='#AA0000'>)</font>
  <font color='#AA0000'>(</font><font color='#0000AA'>set</font> 'c <font color='#AA0000'>(</font>calls f<font color='#AA0000'>)</font><font color='#AA0000'>)</font>
  <font color='#AA0000'>(</font><font color='#0000AA'>set</font> 't <font color='#AA0000'>(</font>times f<font color='#AA0000'>)</font><font color='#AA0000'>)</font>
  <font color='#AA0000'>(</font><font color='#0000AA'>if</font> <font color='#AA0000'>(</font><font color='#0000AA'>or</font> <font color='#AA0000'>(</font><font color='#0000AA'>zero?</font> c<font color='#AA0000'>)</font> <font color='#AA0000'>(</font><font color='#0000AA'>zero?</font> t<font color='#AA0000'>)</font><font color='#AA0000'>)</font> <font color='#665500'>0</font> <font color='#AA0000'>(</font><font color='#0000AA'>div</font> t c<font color='#AA0000'>)</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font>

<font color='#AA0000'>(</font><font color='#0000AA'>define</font> <font color='#AA0000'>(</font>runtime-% f , t t-all<font color='#AA0000'>)</font>
  <font color='#AA0000'>(</font><font color='#0000AA'>set</font> 't <font color='#AA0000'>(</font>times f<font color='#AA0000'>)</font><font color='#AA0000'>)</font>
  <font color='#AA0000'>(</font><font color='#0000AA'>set</font> 't-all <font color='#AA0000'>(</font><font color='#0000AA'>apply</font> '+ <font color='#AA0000'>(</font><font color='#0000AA'>cons</font> <font color='#665500'>0</font> <font color='#AA0000'>(</font><font color='#0000AA'>map</font> times profiled<font color='#AA0000'>)</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font>
  <font color='#AA0000'>(</font><font color='#0000AA'>mul</font> <font color='#665500'>100</font> <font color='#AA0000'>(</font><font color='#0000AA'>div</font> t t-all<font color='#AA0000'>)</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font>

<font color='#AA0000'>(</font><font color='#0000AA'>define</font> <font color='#AA0000'>(</font>report <font color='#AA0000'>(</font>sort-by 'calls<font color='#AA0000'>)</font> , c t p<font color='#AA0000'>)</font> <font color='#555555'>; sort-by can be 'times, 'calls, 'per-call, 'percentage</font>
  <font color='#AA0000'>(</font><font color='#0000AA'>set</font> 'sort-by <font color='#AA0000'>(</font>name sort-by<font color='#AA0000'>)</font><font color='#AA0000'>)</font>
  <font color='#AA0000'>(</font><font color='#0000AA'>let</font> <font color='#AA0000'>(</font><font color='#AA0000'>(</font>col-1 <font color='#AA0000'>(</font>row-width <font color='#AA0000'>(</font>fn <font color='#AA0000'>(</font>p<font color='#AA0000'>)</font> p<font color='#AA0000'>)</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font>
        <font color='#AA0000'>(</font>col-2 <font color='#AA0000'>(</font>row-width <font color='#AA0000'>(</font>fn <font color='#AA0000'>(</font>p<font color='#AA0000'>)</font> <font color='#AA0000'>(</font>calls p<font color='#AA0000'>)</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font>
        <font color='#AA0000'>(</font>col-3 <font color='#AA0000'>(</font>row-width <font color='#AA0000'>(</font>fn <font color='#AA0000'>(</font>p<font color='#AA0000'>)</font> <font color='#AA0000'>(</font>times p<font color='#AA0000'>)</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font>
        <font color='#AA0000'>(</font>col-4 <font color='#AA0000'>(</font>row-width time/call<font color='#AA0000'>)</font><font color='#AA0000'>)</font>
        <font color='#AA0000'>(</font>col-5 <font color='#AA0000'>(</font>row-width runtime-%<font color='#AA0000'>)</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font>
    <font color='#AA0000'>(</font><font color='#0000AA'>println</font> <font color='#AA0000'>(</font><font color='#0000AA'>format</font> <font color='#AA0000'>(</font><font color='#0000AA'>string</font> <font color='#008800'>"%-"</font> col-1 <font color='#008800'>"s | %"</font> col-2 <font color='#008800'>"s | %"</font> col-3 <font color='#008800'>"s | %"</font> col-4 <font color='#008800'>"s | %"</font> col-5 <font color='#008800'>"s"</font><font color='#AA0000'>)</font>
                     <font color='#008800'>"function"</font> <font color='#008800'>"calls"</font> <font color='#008800'>"total ms"</font> <font color='#008800'>"ms/call"</font> <font color='#008800'>"% time"</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font>
    <font color='#AA0000'>(</font><font color='#0000AA'>println</font> <font color='#AA0000'>(</font><font color='#0000AA'>dup</font> <font color='#008800'>"-"</font> <font color='#AA0000'>(</font><font color='#0000AA'>+</font> <font color='#665500'>1</font> col-1<font color='#AA0000'>)</font><font color='#AA0000'>)</font> <font color='#008800'>"+"</font>
             <font color='#AA0000'>(</font><font color='#0000AA'>dup</font> <font color='#008800'>"-"</font> <font color='#AA0000'>(</font><font color='#0000AA'>+</font> <font color='#665500'>2</font> col-2<font color='#AA0000'>)</font><font color='#AA0000'>)</font> <font color='#008800'>"+"</font>
             <font color='#AA0000'>(</font><font color='#0000AA'>dup</font> <font color='#008800'>"-"</font> <font color='#AA0000'>(</font><font color='#0000AA'>+</font> <font color='#665500'>2</font> col-3<font color='#AA0000'>)</font><font color='#AA0000'>)</font> <font color='#008800'>"+"</font>
             <font color='#AA0000'>(</font><font color='#0000AA'>dup</font> <font color='#008800'>"-"</font> <font color='#AA0000'>(</font><font color='#0000AA'>+</font> <font color='#665500'>2</font> col-4<font color='#AA0000'>)</font><font color='#AA0000'>)</font> <font color='#008800'>"+"</font>
             <font color='#AA0000'>(</font><font color='#0000AA'>dup</font> <font color='#008800'>"-"</font> <font color='#AA0000'>(</font><font color='#0000AA'>+</font> <font color='#665500'>1</font> col-5<font color='#AA0000'>)</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font>
    <font color='#AA0000'>(</font><font color='#0000AA'>dolist</font> <font color='#AA0000'>(</font>f <font color='#AA0000'>(</font><font color='#0000AA'>sort</font> profiled
                     <font color='#AA0000'>(</font>fn <font color='#AA0000'>(</font>a b<font color='#AA0000'>)</font> <font color='#AA0000'>(</font><font color='#0000AA'>case</font> sort-by
                                 <font color='#AA0000'>(</font><font color='#008800'>"calls"</font> <font color='#AA0000'>(</font><font color='#0000AA'>></font> <font color='#AA0000'>(</font>calls a<font color='#AA0000'>)</font> <font color='#AA0000'>(</font>calls b<font color='#AA0000'>)</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font>
                                 <font color='#AA0000'>(</font><font color='#008800'>"times"</font> <font color='#AA0000'>(</font><font color='#0000AA'>></font> <font color='#AA0000'>(</font>times a<font color='#AA0000'>)</font> <font color='#AA0000'>(</font>times b<font color='#AA0000'>)</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font>
                                 <font color='#AA0000'>(</font><font color='#008800'>"per-call"</font> <font color='#AA0000'>(</font><font color='#0000AA'>></font> <font color='#AA0000'>(</font>time/call a<font color='#AA0000'>)</font> <font color='#AA0000'>(</font>time/call b<font color='#AA0000'>)</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font>
                                 <font color='#AA0000'>(</font><font color='#008800'>"percentage"</font> <font color='#AA0000'>(</font><font color='#0000AA'>></font> <font color='#AA0000'>(</font>runtime-% a<font color='#AA0000'>)</font> <font color='#AA0000'>(</font>runtime-% b<font color='#AA0000'>)</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font>
      <font color='#AA0000'>(</font><font color='#0000AA'>println</font> <font color='#AA0000'>(</font><font color='#0000AA'>format</font> <font color='#AA0000'>(</font><font color='#0000AA'>string</font> <font color='#008800'>"%-"</font> col-1 <font color='#008800'>"s | %"</font> col-2 <font color='#008800'>"d | %"</font> col-3 <font color='#008800'>"d | %"</font> col-4 <font color='#008800'>"f | %"</font> col-5 <font color='#008800'>".2f"</font><font color='#AA0000'>)</font>
                       f <font color='#AA0000'>(</font>calls f<font color='#AA0000'>)</font> <font color='#AA0000'>(</font>times f<font color='#AA0000'>)</font> <font color='#AA0000'>(</font>time/call f<font color='#AA0000'>)</font> <font color='#AA0000'>(</font>runtime-% f<font color='#AA0000'>)</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font>
  <font color='#AA0000'>(</font>reset-functions<font color='#AA0000'>)</font>
  <font color='#AA0000'>(</font>reset-statistics<font color='#AA0000'>)</font><font color='#AA0000'>)</font>

<font color='#555555'>;; <font color='#308080'>@syntax</font> (Profiler:profiled-function &lt;func&gt;)</font>
<font color='#555555'>;; <font color='#308080'>@param</font> &lt;func&gt; function to profile</font>
<font color='#555555'>;; &lt;p&gt;Returns a modified function to use with the profiler.&lt;/p&gt;</font>
<font color='#AA0000'>(</font><font color='#0000AA'>define-macro</font> <font color='#AA0000'>(</font>profiled-function<font color='#AA0000'>)</font>
  <font color='#AA0000'>(</font><font color='#0000AA'>letex</font> <font color='#AA0000'>(</font><font color='#AA0000'>(</font>fn-name <font color='#AA0000'>(</font><font color='#0000AA'>string</font> <font color='#AA0000'>(</font><font color='#0000AA'>args</font> <font color='#665500'>0</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font>
          <font color='#AA0000'>(</font>fn-calls <font color='#AA0000'>(</font><font color='#0000AA'>sym</font> <font color='#AA0000'>(</font><font color='#0000AA'>string</font> <font color='#008800'>"_"</font> <font color='#AA0000'>(</font><font color='#0000AA'>args</font> <font color='#665500'>0</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font> calls<font color='#AA0000'>)</font><font color='#AA0000'>)</font>
          <font color='#AA0000'>(</font>fn-times <font color='#AA0000'>(</font><font color='#0000AA'>sym</font> <font color='#AA0000'>(</font><font color='#0000AA'>string</font> <font color='#008800'>"_"</font> <font color='#AA0000'>(</font><font color='#0000AA'>args</font> <font color='#665500'>0</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font> times<font color='#AA0000'>)</font><font color='#AA0000'>)</font>
          <font color='#AA0000'>(</font>func <font color='#AA0000'>(</font><font color='#0000AA'>args</font> <font color='#665500'>0</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font>
    <font color='#AA0000'>(</font><font color='#0000AA'>when</font> <font color='#AA0000'>(</font><font color='#0000AA'>or</font> <font color='#AA0000'>(</font><font color='#0000AA'>protected?</font> func<font color='#AA0000'>)</font> <font color='#AA0000'>(</font><font color='#0000AA'>not</font> <font color='#AA0000'>(</font><font color='#0000AA'>lambda?</font> func<font color='#AA0000'>)</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font>
          <font color='#AA0000'>(</font><font color='#0000AA'>throw-error</font> <font color='#AA0000'>(</font><font color='#0000AA'>format</font> <font color='#008800'>"%s is protected or not a function"</font> fn-name<font color='#AA0000'>)</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font>
    <font color='#AA0000'>(</font><font color='#0000AA'>push</font> fn-name profiled<font color='#AA0000'>)</font>
    <font color='#AA0000'>(</font>calls fn-name <font color='#665500'>0</font><font color='#AA0000'>)</font>
    <font color='#AA0000'>(</font>times fn-name <font color='#665500'>0</font><font color='#AA0000'>)</font>
    <font color='#AA0000'>(</font><font color='#0000AA'>letex</font> <font color='#AA0000'>(</font><font color='#AA0000'>(</font>params <font color='#AA0000'>(</font><font color='#0000AA'>first</font> func<font color='#AA0000'>)</font><font color='#AA0000'>)</font> <font color='#AA0000'>(</font>body <font color='#AA0000'>(</font><font color='#0000AA'>cons</font> 'begin <font color='#AA0000'>(</font><font color='#0000AA'>rest</font> func<font color='#AA0000'>)</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font>
      <font color='#AA0000'>(</font>lambda params
        <font color='#AA0000'>(</font><font color='#0000AA'>local</font> <font color='#AA0000'>(</font>res<font color='#AA0000'>)</font>
          <font color='#AA0000'>(</font><font color='#0000AA'>inc</font> fn-calls<font color='#AA0000'>)</font>
          <font color='#AA0000'>(</font><font color='#0000AA'>inc</font> fn-times <font color='#AA0000'>(</font><font color='#0000AA'>time</font> <font color='#AA0000'>(</font><font color='#0000AA'>set</font> 'res body<font color='#AA0000'>)</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font>
          res<font color='#AA0000'>)</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font>

<font color='#555555'>;; <font color='#308080'>@syntax</font> (Profiler:profile-functions &lt;list-functions&gt;)</font>
<font color='#555555'>;; <font color='#308080'>@param</font> &lt;list-functions&gt; list of functions to profile</font>
<font color='#555555'>;; &lt;p&gt;Sets functions listed in &lt;list-functions&gt; to have statistics collected while</font>
<font color='#555555'>;; they run.  Protected and built-in functions cannot be profiled.&lt;/p&gt;</font>
<font color='#555555'>;; <font color='#308080'>@example</font></font>
<font color='#555555'>;; (define (foo x y) (+ x y))</font>
<font color='#555555'>;; (define (bar x y) (foo x y))</font>
<font color='#555555'>;; (Profiler:profile-functions '(foo bar))</font>
<font color='#555555'>;; => '(foo bar)</font>
<font color='#AA0000'>(</font><font color='#0000AA'>define</font> <font color='#AA0000'>(</font>profile-functions fns<font color='#AA0000'>)</font>
  <font color='#AA0000'>(</font>reset-statistics<font color='#AA0000'>)</font>
  <font color='#AA0000'>(</font><font color='#0000AA'>dolist</font> <font color='#AA0000'>(</font>f fns<font color='#AA0000'>)</font>
    <font color='#AA0000'>(</font><font color='#0000AA'>letex</font> <font color='#AA0000'>(</font><font color='#AA0000'>(</font>f f<font color='#AA0000'>)</font><font color='#AA0000'>)</font>
      <font color='#AA0000'>(</font><font color='#0000AA'>push</font> <font color='#AA0000'>(</font><font color='#0000AA'>list</font> 'f f<font color='#AA0000'>)</font> originals<font color='#AA0000'>)</font>
      <font color='#AA0000'>(</font><font color='#0000AA'>set</font> 'f <font color='#AA0000'>(</font>profiled-function f<font color='#AA0000'>)</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font>
  fns<font color='#AA0000'>)</font>

<font color='#555555'>;; <font color='#308080'>@syntax</font> (Profiler:profile-context &lt;ctx&gt; [&lt;ctx-2&gt; ...])</font>
<font color='#555555'>;; <font color='#308080'>@param</font> &lt;ctx&gt; context to profile</font>
<font color='#555555'>;; &lt;p&gt;Updates all functions in context &lt;ctx&gt; to be profiled.&lt;/p&gt;</font>
<font color='#555555'>;; <font color='#308080'>@example</font></font>
<font color='#555555'>;; (define (foo:foo x y) (+ x y))</font>
<font color='#555555'>;; (define (foo:bar x y) (foo x y))</font>
<font color='#555555'>;; (Profiler:profile-context foo)</font>
<font color='#555555'>;; => '(foo:bar foo:foo)</font>
<font color='#AA0000'>(</font><font color='#0000AA'>define</font> <font color='#AA0000'>(</font>profile-context<font color='#AA0000'>)</font>
  <font color='#AA0000'>(</font>profile-functions <font color='#AA0000'>(</font><font color='#0000AA'>clean</font> <font color='#AA0000'>(</font>lambda <font color='#AA0000'>(</font>s<font color='#AA0000'>)</font>
                              <font color='#AA0000'>(</font><font color='#0000AA'>or</font> <font color='#AA0000'>(</font><font color='#0000AA'>protected?</font> s<font color='#AA0000'>)</font>
                                  <font color='#AA0000'>(</font><font color='#0000AA'>not</font> <font color='#AA0000'>(</font><font color='#0000AA'>lambda?</font> <font color='#AA0000'>(</font><font color='#0000AA'>eval</font> s<font color='#AA0000'>)</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font>
                            <font color='#AA0000'>(</font><font color='#0000AA'>apply</font> 'append <font color='#AA0000'>(</font><font color='#0000AA'>map</font> 'symbols <font color='#AA0000'>(</font><font color='#0000AA'>args</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font><font color='#AA0000'>)</font>

<font color='#AA0000'>(</font><font color='#0000AA'>context</font> 'MAIN<font color='#AA0000'>)</font>


</pre><center><font face='Arial' size='-3' color='#666666'>syntax highlighting with <a href="http://newlisp.org">newLISP</a>&nbsp;and <a href="http://newlisp.org/newLISPdoc.html">newLISPdoc</a></font></center></body></html>